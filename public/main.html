<html>
  <head>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-particle-system-component@1.1.3/dist/aframe-particle-system-component.min.js"></script>
    <script src="https://unpkg.com/aframe-tangram-terrain-component/dist/aframe-tangram-terrain-component.min.js"></script>
    <script src="https://unpkg.com/aframe-aabb-collider-component@3.1.0/dist/aframe-aabb-collider-component.min.js"></script>
    <script src="https://unpkg.com/aframe-proxy-event-component/dist/aframe-proxy-event-component.min.js"></script>
    <link rel="stylesheet" href="static/opening.css" />
  </head>

  <body>
    <title>
      When Once The Sky Was Blue
    </title>
    <a-scene
      loading-screen="dotsColor: white; backgroundColor: black"
      vr-mode-ui="enabled: false"
    >
      <a-assets>
        <img id="shadow" crossorigin="anonymous" src="static/shadow.png">
        <a-asset-item id="francis-obj" src="static/cloak.obj"></a-asset-item>
        <a-asset-item id="francis-mtl" src="static/cloak.mtl"></a-asset-item>
        <img id="skymap" src="textures/sky2.png" crossorigin="anonymous" />
        <img id="flare" src="textures/flare.jpg" />
        <img
          id="sky"
          src="https://cdn.glitch.com/51bf6811-51a6-4392-8725-e93a5c65ce3b%2Fgif.gif?v=1605426636772"
        />
        <a-asset-item
          id="yamlElevation"
          src="https://raw.githubusercontent.com/tangrams/terrain-demos/master/styles/terrarium-elevation.yaml"
        />
        <img id="moon" src="textures/CMdOmV9W8AA5--n.png" />
        <img id="map" src="textures/tahoe_map.jpg" />

        <img id="normalmap" src="textures/normalmap.png" />
        <img id="skyOne" src="textures/starry.png" />

        <img
          id="normalMapCracks"
          src="textures/cracksTextures/crackNormal.png"
        />
        <img
          id="cracksTexture"
          src="textures/cracksTextures/crackTexture.png"
        />
        <img id="cracksWhite" src="textures/cracksTextures/crackWhite.png" />
      </a-assets>
      <a-entity id="lobby" visible="true">
        <a-plane
          position="0 0 -4"
          rotation="-90 0 0"
          width="10000"
          height="10000"
          color="#222"
          scale=" 5 5 1"
          material="roughness: 1"
          animation="property: color; dur: 4000;
          from: #ffffff; to: #222;
          loop: false; dir: alternate; autoplay: true"
        ></a-plane>
        <a-sky
          id="lobbySky"
          color="#ffffff"
          animation__one="property: color; dur: 4000;
        from: #ffffff; to: #000000;
        loop: false; dir: alternate; autoplay: true"
          animation="property: color; from:#000000; to: #ffffff; loop: 1; dur: 2000; delay:100; dir: alternate; autoplay: false"
        >
        </a-sky>
        <a-sky
          id="lobbySkyTransitionTwo"
          color="#ffffff"
          animation__one="property: color; dur: 4000;
      from: #ffffff; to: #000000;
      loop: false;  dir: alternate; autoplay: true"
          animation="property: color; dir: alternate; dur: 1800; delay: 50; loop: false; repeat: 1; from: #000000; to: #ffffff; autoplay: false"
        >
        </a-sky>
        <a-sky
          id="lobbySkyTransitionThree"
          color="#ffffff"
          animation__one="property: color; dur: 4000;
    from: #ffffff; to: #000000;
    loop: false; dir: alternate; autoplay: true"
          animation="property: color; dir: alternate; dur: 1800; delay: 50; loop: false; repeat: 1; from: #000000; to: #ffffff; autoplay: false"
        >
        </a-sky>
        <a-entity position="0 1 0">
          <a-entity camera foo look-controls wasd-controls id="lobbyCam">
            <!-- this is the cursor, the startEvents: click is what triggers transitions in #francis1 #francis2 #francis3-->
            <a-entity
              id="cursorReticle"
              position="0 0 -1.2"
              animation__click="property: geometry.thetaLength; startEvents: click; easing: easeInCubic; dur: 2000; from: 359; to: 360"
              animation__fusing="property: geometry.thetaLength; startEvents: fusing; easing: easeInCubic; dur: 1500; from: 0; to: 359"
              animation__mouseleave="property: geometry.thetaLength; startEvents: mouseleave; easing: easeInCubic; dur: 500; to: 0"
              geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.035;"
              material="color: black; shader: flat; opacity: 1"
              cursor="maxDistance: 3; fuse: true"
              raycaster="far: 3; objects: .francis"
            >
            </a-entity>
          </a-entity>
        </a-entity>
        <a-entity
          light="color: #BBB; type: ambient"
          data-aframe-default-light=""
          aframe-injected=""
          visible=""
          color="#ffffff"
          animation="property: color; dur: 4000;
        from: #ffffff; to: #BBB;
        loop: false; reapeat: 3; dir: alternate; autoplay: true"
        ></a-entity>
        <a-entity
          light="intensity: 1.2; castShadow: true"
          position="-0.5 1 1"
          data-aframe-default-light=""
          aframe-injected=""
          visible=""
          animation="property: color; dur: 4000;
          from: #ffffff; to: #BBB;
          loop: false; reapeat: 3; dir: alternate; autoplay: true"
        ></a-entity>
        <!-- all these lights are used to transition between scenes and when entering the lobby as well -->
        <a-light
          type="point"
          intensity="1"
          id="francis1Light"
          color="white"
          distance="3.6"
          position="-5 1 -3"
          animation="property: intensity; dur: 4000;
        from: 6; to: 1.5;
        loop: false; reapeat: 3; dir: alternate; autoplay: true"
        >
        </a-light>
        <a-light
          type="point"
          intensity="1"
          id="francis1LightTwo"
          color="white"
          distance="3.6"
          position="-5 1 -3"
          animation="property: intensity; dur: 4000;
       from: 0.6; to: 6;
       loop: false; reapeat: 3; dir: alternate; autoplay: false"
        >
        </a-light>
        <a-entity
          francis1mouseenter
          id="francis1"
          class="francis"
          obj-model="obj: #francis-obj; mtl: #francis-mtl"
          position="-5.048 -0.238 -3"
          scale="0.03 0.03 0.03"
          rotation="0 50 0"
          light="type: hemisphere; color: white; intensity: 0;"
          animation__rotation="property: light.intensity; from:0; to: 6; loop: 1; dur: 2000; delay:100; dir: alternate; startEvents: click;"
        >
        </a-entity>
        <a-light
          type="point"
          intensity="1"
          id="francis2LightTwo"
          color="white"
          distance="3.6"
          position="0 1 -6"
          animation="property: intensity; dur: 4000;
     from: 0.6; to: 6;
     loop: false; reapeat: 3; dir: alternate; autoplay: false"
        >
        </a-light>
        <a-light
          type="point"
          intensity="1"
          id="francis3LightTwo"
          color="white"
          distance="3.6"
          position="4.748 0.4 -3"
          animation="property: intensity; dur: 4000;
   from: 0.6; to: 6;
   loop: false; reapeat: 3; dir: alternate; autoplay: false"
        >
        </a-light>
        <!-- event from cursor is what triggers this, triggered when the cursor reticls becomes a full circle. -->
        <a-entity
          francis2mouseenter
          id="francis2"
          class="francis"
          obj-model="obj: #francis-obj; mtl: #francis-mtl"
          position="0 -0.238 -6.897"
          scale="0.03 0.03 0.03"
          light="type: hemisphere; color: white; intensity: 0;"
          animation__rotation="property: light.intensity; from:0; to: 6; loop: 1; dur: 2000; delay:100; dir: alternate; startEvents: click;"
        ></a-entity>
        <a-entity
          francis3mouseenter
          id="francis3"
          class="francis"
          obj-model="obj: #francis-obj; mtl: #francis-mtl"
          position="4.748 -0.238 -3"
          scale="0.03 0.03 0.03"
          rotation="0 -50 0"
          light="type: hemisphere; color: white; intensity: 0;"
          animation__rotation="property: light.intensity; from:0; to: 6; loop: 1; dur: 2000; delay:100; dir: alternate; startEvents: click;"
        ></a-entity>
      </a-entity>
      <a-entity shaperain id="firstPerformance" visible="false">
        <a-sky
          id="scene1Sky"
          geometry="primitive:sphere; radius:170; phiLength:360; phiStart:0; thetaLength:90"
          material="shader:flat; side:back; height:2048; src:#skymap; width:2048;"
          animation="property: material.color; dur: 20000;
          from: #ffff00 ; to: #ff5cff;
          loop: false; dir: alternate; autoplay: false"
        ></a-sky>
        <a-entity
          geometry="primitive: plane; width: 340; height: 340; segmentsHeight: 0; segmentsWidth: 0;"
          rotation="-90 0 0"
          position="0 0 0"
          material="roughness: 1; normalMap: #normalMapCracks; normalScale: 10; color: #0f0f0f; src:#cracksWhite; repeat: 22 22"
        ></a-entity>
        <a-light type="directional" position="0 2 0"></a-light>
        <a-entity
          id="floorToFadeScene1"
          geometry="primitive: plane; width: 340; height: 340; segmentsHeight: 0; segmentsWidth: 0;"
          rotation="-90 0 0"
          position="0 0 0"
          material="roughness: 1; normalScale: 10; color: #0f0f0f;"
          animation="property: material.opacity; dur: 20000;
          from:0; to: 1;
          loop: false; dir: alternate; autoplay: false"
        ></a-entity>
      </a-entity>

      <a-entity id="secondPerformance" visible="false">
        <a-sky
          id="scene2Sky"
          color="#ffc04c "
          animation="property: material.color; dur: 20000;
        from: #ffc04c ; to: #4c0000;
        loop: false; dir: alternate; autoplay: false"
        ></a-sky>
        <a-entity
          position="0 2.25 -15"
          particle-system="preset: dust"
        ></a-entity>
        <a-entity
          id="particles"
          position="0 5 -15"
          particle-system="opacity:color: #FF4500,#FFF; size: 0.5; positionSpread: 25 25 25; texture: ./textures/particletexture.png; accelerationValue: 0 -1.2 0; velocityValue: 0 0.001 0; maxParticleCount: 2500; rotationAngle: 1.4"
          animation__2="property: opacity; dur: 5000;
        from: 0; to: 1;
        loop: false; dir: alternate; autoplay: true"
        ></a-entity>
      </a-entity>
      <a-entity id="thirdPerformance" visible="false">
        <a-sky
          src="#skyOne"
          geometry="radius: 100; thetaLength: 100"
          rotation="-90 0 0"
        ></a-sky>

        <a-sky
          src="#skyOne"
          geometry="radius: 100; thetaLength: 100; primitive: box; width: 100; height: 100; depth: 100;"
          rotation="90 0 0"
        ></a-sky>
        <a-entity
          id="planeToFollow"
          geometry="primitive: plane; width: 2; height: 2; segmentsHeight: 20; segmentsWidth: 20;"
          rotation="-90 0 0"
          position="0 0 0"
          material="color: #ffffff"
        ></a-entity>
      </a-entity>
    </a-scene>
    <script src="js/lib/jquery-3.5.1.js"></script>
    <script src = "js/lib/socket.io.js"></script>
    <script src="js/main.js"></script>
  </body>
</html>




